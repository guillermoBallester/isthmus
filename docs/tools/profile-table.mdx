---
title: "profile_table"
description: "Deep table profiling: sample rows, disk usage, index usage, and inferred relationships."
---

## Description

Deep-profile a single table: sample rows, disk size breakdown (table/indexes/TOAST), index usage statistics (which indexes are actually used vs unused), inferred foreign key relationships (detected from naming patterns like `*_id`), and statistics freshness warnings.

Use this when you need deeper analysis than `describe_table` provides — for example, to see actual data patterns in sample rows, find unused indexes, or discover implicit relationships in databases without explicit foreign keys.

## Parameters

| Parameter | Type | Required | Description |
|---|---|---|---|
| `table_name` | string | Yes | Name of the table to profile |
| `schema` | string | No | Schema name (resolves automatically if omitted) |

## Response schema

| Field | Type | Description |
|---|---|---|
| `schema` | string | Schema name |
| `name` | string | Table name |
| `row_estimate` | integer | Estimated row count |
| `total_bytes` | integer | Total size (table + indexes + TOAST) |
| `table_bytes` | integer | Table data size |
| `index_bytes` | integer | Total index size |
| `size_human` | string | Human-readable total size |
| `sample_rows` | array | Up to 5 sample rows as key-value objects |
| `index_usage` | array | Per-index usage statistics (see below) |
| `inferred_fks` | array | Foreign keys inferred from naming patterns (see below) |
| `stats_age` | string | Timestamp of last `ANALYZE` (omitted if unknown) |
| `stats_age_warning` | string | Warning if statistics are stale (omitted if fresh) |
| `extra` | object | Additional key-value metadata (omitted if empty) |

### Index usage object

| Field | Type | Description |
|---|---|---|
| `name` | string | Index name |
| `scans` | integer | Number of index scans since last stats reset |
| `size_bytes` | integer | Index size in bytes |
| `size_human` | string | Human-readable index size |

### Inferred FK object

| Field | Type | Description |
|---|---|---|
| `column_name` | string | Column in this table (e.g. `customer_id`) |
| `referenced_table` | string | Inferred referenced table |
| `referenced_column` | string | Inferred referenced column |
| `confidence` | string | `"high"`, `"medium"`, or `"low"` |
| `reason` | string | Why this relationship was inferred |

## Example response

```json
{
  "schema": "public",
  "name": "orders",
  "row_estimate": 248000,
  "total_bytes": 47185920,
  "table_bytes": 38797312,
  "index_bytes": 8388608,
  "size_human": "45 MB",
  "sample_rows": [
    {
      "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
      "customer_id": "f0e1d2c3-b4a5-6789-0123-456789abcdef",
      "status": "paid",
      "amount_cents": 4999,
      "created_at": "2026-01-15T14:30:00Z"
    },
    {
      "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
      "customer_id": "e1d2c3b4-a5f6-7890-1234-56789abcdef0",
      "status": "shipped",
      "amount_cents": 12500,
      "created_at": "2026-02-01T09:15:00Z"
    }
  ],
  "index_usage": [
    {
      "name": "orders_pkey",
      "scans": 152340,
      "size_bytes": 5242880,
      "size_human": "5120 kB"
    },
    {
      "name": "orders_customer_id_idx",
      "scans": 48210,
      "size_bytes": 3145728,
      "size_human": "3072 kB"
    },
    {
      "name": "orders_created_at_idx",
      "scans": 0,
      "size_bytes": 2097152,
      "size_human": "2048 kB"
    }
  ],
  "inferred_fks": [
    {
      "column_name": "customer_id",
      "referenced_table": "customers",
      "referenced_column": "id",
      "confidence": "high",
      "reason": "column name matches pattern *_id and table 'customers' exists with 'id' column"
    }
  ],
  "stats_age": "2026-02-25T12:00:00Z"
}
```

## Notes

- Sample rows are fetched with `LIMIT 5` using a `TABLESAMPLE` clause when available for performance.
- Index usage stats come from `pg_stat_user_indexes`. An index with `scans: 0` may be unused and a candidate for removal.
- Inferred FKs are heuristic — they detect patterns like `customer_id` referencing `customers.id`. Always verify before relying on them for JOINs. Explicit foreign keys from `describe_table` are authoritative.
- The `stats_age_warning` field appears when the last `ANALYZE` is older than 7 days.
